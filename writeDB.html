<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inserisci Record in Firestore</title>
</head>
<body>
    <h1>Inserisci un nuovo record in Firestore</h1>

    <!-- Form per inserire i dati -->
    <form id="form">
        <label for="id_campagna">ID Campagna:</label>
        <input type="number" id="id_campagna" required><br><br>

        <label for="nome_campagna">Nome Campagna:</label>
        <input type="text" id="nome_campagna" required><br><br>

        <label for="giocatori">Giocatori (separati da virgola):</label>
        <input type="text" id="giocatori"><br><br>

        <button type="submit">Inserisci Record</button>
    </form>

    <!-- Includi Firebase SDK versione 8.x.x -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <script>
        // Inizializza Firebase con la tua configurazione
        const firebaseConfig = {
            apiKey: "AIzaSyBpgYB4_8gIT20m9u3sNMpVhqVytrBpZ20",
            authDomain: "test-fire-realtime-db.firebaseapp.com",
            databaseURL: "https://test-fire-realtime-db-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "test-fire-realtime-db",
            storageBucket: "test-fire-realtime-db.appspot.com",
            messagingSenderId: "791679169237",
            appId: "1:791679169237:web:a441e09863db2ad3ff685c",
            measurementId: "G-LGSPN89S5W"
        };

        // Inizializza l'app Firebase
        firebase.initializeApp(firebaseConfig);

        // Ottieni un riferimento al database Firestore
        const db = firebase.firestore();

        // Riferimento alla collezione "ArcaneTomesTavern/campagne"
        const campagneRef = db.collection("ArcaneTomesTavern").doc("campagne");

        // Riferimenti agli input del form
        const form = document.getElementById("form");
        const idCampagnaInput = document.getElementById("id_campagna");
        const nomeCampagnaInput = document.getElementById("nome_campagna");
        const giocatoriInput = document.getElementById("giocatori");

        // Gestisci l'invio del form
        form.addEventListener("submit", function (e) {
            e.preventDefault();

            const idCampagna = parseInt(idCampagnaInput.value);
            const nomeCampagna = nomeCampagnaInput.value;
            const giocatori = giocatoriInput.value.split(",").map((giocatore) => giocatore.trim());

            // Inserisci il nuovo record nel database Firestore
            campagneRef.update({
                [idCampagna]: {
                    id_campagna: idCampagna,
                    nome_campagna: nomeCampagna,
                    giocatori: giocatori
                }
            })
            .then(() => {
                console.log("Record inserito con successo!");
                // Puoi effettuare azioni aggiuntive qui, se necessario
            })
            .catch((error) => {
                console.error("Errore nell'inserimento del record:", error);
            });
        });
    </script>
</body>
</html>
